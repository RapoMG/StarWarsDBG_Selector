#:import NoTransition kivy.uix.screenmanager.NoTransition


ScreenManager:
    transition: NoTransition()
    PlayersWindow:
    FactionsWindow:
    DrawResultsWindow:

### Definitions ###
<Button>
    font_size: 32
    size_hint: (0.15,0.045)

<CheckBox>
    size_hint_x: 0.3
    size_hint_y: 0.1

<Summary@Label>
    color: (0.812, 0.796, 0.043)

    outline_color: (0, 0, 0)
    outline_width: 2

    halign:"center"
    valign:"middle"

#Background settings
<Background@Widget>
    size: root.width, root.height
    orientation: "horizontal"
    spacing: 10

    canvas:
        Rectangle:
            source:'images/background.png'
            size: root.width, root.height
            pos: self.pos

<Set@Label>
    font_size: 28
    outline_color: (0, 0, 0)
    outline_width: 2
    color: (1,1,1,1)
    size_hint_y: 0.2

<Faction@Label>
    font_size: 20
    outline_color: (0, 0, 0)
    outline_width: 1
    color: (1,1,1,1)
    size_hint_y: 0.2

<Next@Button>
    color: (0,0,0,1)
    font_size: 20
    italic: True

    background_color: (1,1,1,1)
    background_normal: ""

    pos_hint :{'center_x':0.5, 'center_y':0.25}
    size_hint: .50, .058


<Back@Button>
    color: (0,0,0,1)
    font_size: 16
    italic: True

    background_color: (1,1,1,1)
    background_normal: ""

    pos_hint :{'center_x':0.5, 'center_y':0.1}
    size_hint: .25, .041

### Screens ###

<PlayersWindow>
    name: "p_number"

    FloatLayout:
        #Call Background object
        Background:

        Label:
            text: "Players"
            pos_hint: {"center_y":.7, "center_x":0.38}
            font_size: 56
            outline_color: (0, 0, 0)
            outline_width: 1

        Label:
            id: n_players
            text: root.nbr_plyrs
            font_size: 56
            bold: True
            outline_color: (0.855, 0.361, 1)
            outline_width: 2
            pos_hint: {"center_y":.7, "center_x":0.73}

        Button:
            text: "+"
            bold: True
            pos_hint: {"center_y":.77, "center_x":0.73}
            on_press: root.incr()

        Button:
            text: "-"
            bold: True
            pos_hint: {"center_y":.63, "center_x":0.73}
            on_press: root.decr()

        Next:
            text: "That is... acceptable"
            on_release:
                app.root.current = "factions"
                root.players()


<FactionsWindow>
    name: "factions"

    FloatLayout:
        #Call Background object
        Background:

        Summary:
            # Value shared in app class
            text: f"{app.shared_players} players game"
            font_size: 20

            pos_hint: {"center_y":.94, "center_x":0.5}

        GridLayout:
            rows: 7
            cols: 2

            size_hint_x: 0.8
            size_hint_y: 0.50
            pos_hint: {"center_y":.62, "center_x":0.52}

            Set:
                text: f"{app.fc[0].box}"

            CheckBox:
                id: set1
                on_release:
                    root.updt_stat() # Necessary to work with first use
                    root.set_flipper(self, self.active)
                    root.updt_stat()

            Faction:
                text: f"{app.fc[0].name}"

            CheckBox:
                id: set1_f1
                on_release:
                    root.set_splitter()
                    root.updt_stat()

            Faction:
                text: f"{app.fc[1].name}"

            CheckBox:
                id: set1_f2
                on_release:
                    root.set_splitter()
                    root.updt_stat()

            Set:
                text: f"{app.fc[2].box}"

            CheckBox:
                id: set2
                on_release:
                    root.updt_stat() # Necessary to work with first use
                    root.set_flipper(self, self.active)
                    root.updt_stat()

            Faction:
                text: f"{app.fc[2].name}"

            CheckBox:
                id: set2_f1
                on_release:
                    root.set_splitter()
                    root.updt_stat()

            Faction:
                text: f"{app.fc[3].name}"

            CheckBox:
                id: set2_f2
                on_release:
                    root.set_splitter()
                    root.updt_stat()

            Set:
                text: f"{app.fc[4].name}"


            CheckBox:
                id: exp1
                on_release: root.updt_stat()

        Back:
            text: "Go back"
            on_release:
                app.root.current = "p_number"

        Next:
            id: hidden_next
            text: "All wigs report in"
            opacity: 0
            on_release:
                root.draw()
                app.root.current = "result"



<DrawResultsWindow>
    name: "result"
    on_pre_enter: root.result()
    FloatLayout:
        Background:
        Summary:
            # Value shared in app class
            text: f"{app.shared_players} players game"
            font_size: 20

            pos_hint: {"center_y":.94, "center_x":0.5}

        Summary:
            id: f_line1
            text: f"Who is here?"
            font_size: 26

            pos_hint: {"center_y":.86, "center_x":0.5}

        Summary:
            id: con_line1
            text: f"versus"
            font_size: 20

            pos_hint: {"center_y":.78, "center_x":0.5}

        Summary:
            id: f_line2
            text: f"To be announced..."
            font_size: 26

            pos_hint: {"center_y":.70, "center_x":0.5}

        Summary:
            id: con_line2
            text: f""
            font_size: 20

            pos_hint: {"center_y":.62, "center_x":0.5}

        Summary:
            id: f_line3
            text: f""
            font_size: 26

            pos_hint: {"center_y":.54, "center_x":0.5}

        Summary:
            id: f_line4
            text: f""
            font_size: 26

            pos_hint: {"center_y":.42, "center_x":0.5}

        Back:
            text: "Go back"

            on_release:
                app.root.current = "factions"
                root.manager.transition.direction = "left"
                root.clean()
